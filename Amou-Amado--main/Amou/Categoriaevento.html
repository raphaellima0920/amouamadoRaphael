<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventos Culturais | Amou, Amado?</title>
    <link rel="stylesheet" href="categoriaevento.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo-search-container">
            <div class="logo-container">
                <a href="#">
                    <img src="imagens/logo.png"  alt="Logo"   class="main-logo">
                </a>
            </div>
            
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Pesquisar eventos, artistas, locais..." aria-label="Campo de pesquisa">
                <i class="fas fa-search search-icon"></i>
            </div>
        </div>

        <div class="header-actions">
            <button class="header-btn btn-create">
                <i class="fas fa-plus-circle"></i> <span class="btn-text">Criar Evento</span>
            </button>
            <button class="header-btn btn-events">
                <i class="fas fa-calendar-check"></i> <span class="btn-text">Meus Eventos</span>
            </button>
            <button class="header-btn btn-profile">
                <i class="fas fa-user-circle"></i> <span class="btn-text">Perfil</span>
            </button>
        </div>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container">
        <h1 class="page-title" id="page-title">Teatro e Apresentações</h1>
        
        <p class="category-description" id="category-description">
            Descubra as mais emocionantes peças teatrais, performances e apresentações artísticas da comunidade LGBTQIA+ de Salvador. 
            De clássicos reinventados a produções contemporâneas, encontre cultura, emoção e representatividade.
        </p>
        
        <!-- Filtros (sem categoria) -->
        <section class="filters">
            <div class="filter-group">
                <label for="date-filter">Filtrar por Data</label>
                <select id="date-filter">
                    <option value="all">Todas as datas</option>
                    <option value="week">Esta semana</option>
                    <option value="month">Este mês</option>
                    <option value="upcoming">Próximos eventos</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="price-filter">Filtrar por Preço</label>
                <select id="price-filter">
                    <option value="all">Todos os preços</option>
                    <option value="free">Gratuitos</option>
                    <option value="50">Até R$ 50</option>
                    <option value="100">Até R$ 100</option>
                    <option value="200">Até R$ 200</option>
                </select>
            </div>
            
            <div class="filter-buttons">
                <button class="btn-apply" id="apply-filters">Aplicar Filtros</button>
                <button class="btn-reset" id="reset-filters">Limpar</button>
            </div>
        </section> 
        
        <!-- Grid de Eventos -->
        <section class="events-grid" id="events-container">
            <!-- Os eventos serão inseridos aqui pelo JavaScript -->
        </section>
    </main>
    
    <!-- Rodapé -->
    <footer>
        <div class="container footer-content">
            <div class="footer-section">
                <h3>Sobre Nós</h3>
                <p>A Amou, Amado? é uma plataforma que busca dar visibilidade para os eventos culturais 
                    e educativos feitos por e para o público LGBTQIA+ de Salvador.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>Links Rápidos</h3>
                <ul class="footer-links">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Eventos</a></li>
                    <li><a href="#">Artistas</a></li>
                    <li><a href="#">Locais</a></li>
                    <li><a href="#">Promoções</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Contato</h3>
                <ul class="footer-links">
                    <li><i class="fas fa-envelope"></i> Amouamadocontato@gmail.com</li>
                    <li><i class="fas fa-phone"></i> (71) 99999-9999</li>
                    <li><i class="fas fa-map-marker-alt"></i> Salvador, BA - Brasil</li>
                </ul>
            </div>
        </div>
        
        <div class="copyright container">
            <p>&copy; 2023 Amou, Amado?. Todos os direitos reservados.</p>
        </div>
    </footer>
<script>
    const categoryData = {
        teatro: {
            title: "Teatro e Apresentações",
            description: "Descubra as mais emocionantes peças teatrais, performances e apresentações artísticas da comunidade LGBTQIA+ de Salvador. De clássicos reinventados a produções contemporâneas, encontre cultura, emoção e representatividade.",
            backendValue: "Teatro e apresentações"
        },
        palestras: {
            title: "Palestras e Oficinas",
            description: "Encontre palestras, workshops e oficinas que promovem conhecimento, diálogo e empoderamento da comunidade LGBTQIA+ em Salvador.",
            backendValue: "Palestras e Oficinas"
        },
        shows: {
            title: "Shows e Festas",
            description: "Aproveite a vida noturna de Salvador com os melhores shows, festas e eventos sociais voltados para o público LGBTQIA+. Celebre a diversidade com música, dança e alegria.",
            backendValue: "Shows e Festas"
        }
    };

    const urlParams = new URLSearchParams(window.location.search);
    const categoriaUrl = urlParams.get('categoria') || 'teatro';
    const categoriaSelecionada = categoryData[categoriaUrl] || categoryData['teatro'];
    let allEvents = [];

    // Atualiza título e descrição da categoria
    document.getElementById('page-title').textContent = categoriaSelecionada.title;
    document.getElementById('category-description').textContent = categoriaSelecionada.description;
    document.title = `${categoriaSelecionada.title} | Amou, Amado?`;

    async function fetchEventsByCategory() {
        try {
            const response = await fetch(`http://localhost:8080/api/eventos/categoria/${encodeURIComponent(categoriaSelecionada.backendValue)}`);
            if (!response.ok) throw new Error('Erro ao buscar eventos');
            const data = await response.json();
            allEvents = data;
            renderEvents(allEvents);
        } catch (err) {
            console.error(err);
            alert('Não foi possível carregar os eventos');
        }
    }

    function renderEvents(events) {
        const container = document.getElementById('events-container');
        container.innerHTML = '';

        if (events.length === 0) {
            container.innerHTML = '<p>Nenhum evento encontrado.</p>';
            return;
        }

        events.forEach(event => {
            const priceText = event.ingressos?.length === 0
                ? 'Gratuito'
                : `R$ ${Math.min(...event.ingressos.map(i => i.preco)).toFixed(2)}`;

            const eventCard = document.createElement('div');
            eventCard.className = 'event-card';
            eventCard.innerHTML = `
                <img src="${event.imagem || 'imagens/banner-padrao.jpg'}" alt="${event.titulo}" class="event-banner">
                <div class="event-content">
                    <h3 class="event-title">${event.titulo}</h3>
                    <div class="event-category">${event.categoria}</div>
                    <div class="event-location">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>${event.cidade} - ${event.estado}</span>
                    </div>
                    <div class="event-date">
                        <i class="far fa-calendar-alt"></i>
                        <span>${formatDate(event.data)} às ${event.horario}</span>
                    </div>
                    <div class="event-info">
                        <span class="duration"><i class="far fa-clock"></i> ${event.duracao || 'Não informada'}</span>
                        <span class="age-rating"><i class="fas fa-user"></i> ${event.classificacaoEtaria || 'Livre'}</span>
                    </div>
                    <div class="event-price">${priceText}</div>
                </div>
            `;
            eventCard.addEventListener('click', () => {
                window.location.href = `descricaoevento.html?id=${event.id}`;
            });

            container.appendChild(eventCard);
        });
    }

    function formatDate(dateStr) {
        const [year, month, day] = dateStr.split('-');
        return `${day}/${month}/${year}`;
    }

    function applyFilters() {
        const dateFilter = document.getElementById('date-filter').value;
        const priceFilter = document.getElementById('price-filter').value;

        let filtered = [...allEvents];

        // Filtro por preço
        if (priceFilter !== 'all') {
            if (priceFilter === 'free') {
                filtered = filtered.filter(e => !e.ingressos || e.ingressos.every(i => i.preco === 0));
            } else {
                const max = parseFloat(priceFilter);
                filtered = filtered.filter(e => e.ingressos && e.ingressos.some(i => i.preco <= max));
            }
        }

        // Filtro por data (simulação simples)
        const hoje = new Date();
        const fimSemana = new Date(hoje);
        fimSemana.setDate(fimSemana.getDate() + 7);

        if (dateFilter === 'week') {
            filtered = filtered.filter(e => new Date(e.data) <= fimSemana);
        } else if (dateFilter === 'month') {
            filtered = filtered.filter(e => new Date(e.data).getMonth() === hoje.getMonth());
        } else if (dateFilter === 'upcoming') {
            filtered = filtered.filter(e => new Date(e.data) >= hoje);
        }

        renderEvents(filtered);
    }

    function searchEvents() {
        const term = document.getElementById('search-input').value.toLowerCase();
        const filtered = allEvents.filter(e =>
            e.titulo.toLowerCase().includes(term) ||
            e.local?.toLowerCase().includes(term) ||
            e.cidade?.toLowerCase().includes(term)
        );
        renderEvents(filtered);
    }

    document.addEventListener('DOMContentLoaded', () => {
        fetchEventsByCategory();

        document.getElementById('apply-filters').addEventListener('click', applyFilters);
        document.getElementById('reset-filters').addEventListener('click', () => {
            document.getElementById('date-filter').value = 'all';
            document.getElementById('price-filter').value = 'all';
            renderEvents(allEvents);
        });

        document.getElementById('search-input').addEventListener('input', searchEvents);
        document.getElementById('search-input').addEventListener('keyup', (e) => {
            if (e.key === 'Enter') searchEvents();
        });
    });
</script>
</body>
</html>