<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Perfil do Organizador</title>
    <link rel="stylesheet" href="edicaoperfil.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>

<body>
    <!-- Header -->
    <header>
        <div class="logo-search-container">
            <div class="logo-container">
                <a href="index.html">
                    <img src="https://via.placeholder.com/150x60?text=LOGO" alt="Logo Amou, Amado?" class="main-logo">
                </a>
            </div>

            <div class="search-bar">
                <input type="text" placeholder="Pesquisar eventos, artistas, locais..." aria-label="Campo de pesquisa">
                <i class="fas fa-search search-icon"></i>
            </div>
        </div>

        <div class="header-actions">
            <a href="criacaoevento.html" class="header-btn btn-create">
                <i class="fas fa-plus-circle"></i> <span class="btn-text">Criar Evento</span>
            </a>
            <a href="eventos.html" class="header-btn btn-events">
                <i class="fas fa-calendar-check"></i> <span class="btn-text">Meus Eventos</span>
            </a>
            <a href="perfilcriador.html" class="header-btn btn-profile">
                <i class="fas fa-user-circle"></i> <span class="btn-text">Perfil</span>
            </a>
        </div>
    </header>

    <!-- Conteúdo Principal - Edição de Perfil -->
    <main class="container">
        <div class="page-header">
            <h1>Editar Perfil do Organizador</h1>
            <p>Atualize as informações do seu perfil para que os participantes possam conhecer melhor sua organização
            </p>
        </div>

        <div class="edit-profile-container">
            <form id="edit-profile-form">
                <!-- Upload de Fotos -->
                <div class="form-section">
                    <h2 class="section-title">Fotos</h2>

                    <div class="photo-upload">
                        <div class="upload-group">
                            <div class="upload-preview" id="avatar-preview">
                                <div class="upload-placeholder">
                                    <i class="fas fa-user-circle"></i>
                                    <p>Nenhuma imagem selecionada</p>
                                </div>
                            </div>
                            <button type="button" class="btn-upload" id="avatar-upload">Selecionar Foto de
                                Perfil</button>
                            <input type="file" id="avatar-input" accept="image/*" hidden>
                        </div>

                        <div class="upload-group">
                            <div class="upload-preview" id="cover-preview">
                                <div class="upload-placeholder">
                                    <i class="fas fa-image"></i>
                                    <p>Nenhuma imagem selecionada</p>
                                </div>
                            </div>
                            <button type="button" class="btn-upload" id="cover-upload">Selecionar Foto de Capa</button>
                            <input type="file" id="cover-input" accept="image/*" hidden>
                        </div>
                    </div>
                </div>

                <!-- Informações Básicas -->
                <div class="form-section">
                    <h2 class="section-title">Informações Básicas</h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="name">Nome do Organizador</label>
                            <input type="text" id="name" class="form-control" placeholder="Digite o nome do organizador"
                                value="Festival Produções">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="location">Localização</label>
                            <input type="text" id="location" class="form-control" placeholder="Cidade, Estado"
                                value="Salvador, BA">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="since">Membro Desde</label>
                        <input type="month" id="since" class="form-control" value="2020-01">
                    </div>
                </div>

                <!-- Biografia -->
                <div class="form-section">
                    <h2 class="section-title">Biografia</h2>

                    <div class="form-group">
                        <label class="form-label" for="bio">Sobre Você</label>
                        <textarea id="bio" class="form-control"
                            placeholder="Conte um pouco sobre você ou sua organização">A Festival Produções é uma empresa especializada em organização de eventos musicais de grande porte na região Nordeste. Com mais de 10 anos de experiência, já trouxemos para Salvador os maiores nomes da música brasileira e internacional, sempre com excelência em produção e atendimento ao público.</textarea>
                    </div>
                </div>

                <!-- Contato -->
                <div class="form-section">
                    <h2 class="section-title">Informações de Contato</h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="email">Email</label>
                            <input type="email" id="email" class="form-control" placeholder="Digite seu email"
                                value="contato@festivalproducoes.com.br">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="phone">Telefone</label>
                            <input type="tel" id="phone" class="form-control" placeholder="(00) 00000-0000"
                                value="(71) 99999-9999">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="website">Website</label>
                            <input type="url" id="website" class="form-control" placeholder="https://exemplo.com"
                                value="www.festivalproducoes.com.br">
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="events">Eventos Realizados</label>
                            <input type="number" id="events" class="form-control" min="0" value="24">
                        </div>
                    </div>
                </div>

                <!-- Redes Sociais -->
                <div class="form-section">
                    <h2 class="section-title">Redes Sociais</h2>

                    <div class="social-media-grid">
                        <div class="social-input">
                            <i class="fab fa-instagram"></i>
                            <input type="text" id="instagram" class="form-control" placeholder="@seuinstagram"
                                value="@festivalproducoes">
                        </div>

                        <div class="social-input">
                            <i class="fab fa-facebook"></i>
                            <input type="text" id="facebook" class="form-control" placeholder="facebook.com/seuperfil">
                        </div>

                        <div class="social-input">
                            <i class="fab fa-twitter"></i>
                            <input type="text" id="twitter" class="form-control" placeholder="@seutwitter">
                        </div>

                        <div class="social-input">
                            <i class="fab fa-linkedin"></i>
                            <input type="text" id="linkedin" class="form-control"
                                placeholder="linkedin.com/in/seuperfil">
                        </div>
                    </div>
                </div>

                <!-- GALERIA DE FOTOS -->
                <div class="form-section gallery-section">
                    <div class="gallery-header">
                        <h2 class="section-title">Galeria de Fotos</h2>
                        <button type="button" class="btn btn-primary" id="add-gallery-btn">
                            <i class="fas fa-plus"></i> Adicionar Fotos
                        </button>
                    </div>

                    <div class="gallery-container" id="gallery-container">
                        <!-- Fotos da galeria serão adicionadas aqui -->
                        <div class="gallery-item">
                            <img src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80"
                                alt="Foto da galeria">
                            <div class="delete-btn"><i class="fas fa-times"></i></div>
                        </div>
                        <div class="gallery-item">
                            <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80"
                                alt="Foto da galeria">
                            <div class="delete-btn"><i class="fas fa-times"></i></div>
                        </div>
                        <div class="gallery-item">
                            <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400&q=80"
                                alt="Foto da galeria">
                            <div class="delete-btn"><i class="fas fa-times"></i></div>
                        </div>

                        <!-- Área para adicionar novas fotos -->
                        <div class="add-gallery-photos" id="add-gallery">
                            <i class="fas fa-images"></i>
                            <p>Adicionar fotos à galeria</p>
                            <small>Arraste ou clique para adicionar</small>
                            <input type="file" id="gallery-input" accept="image/*" multiple hidden>
                        </div>
                    </div>
                </div>

                <!-- Botões de Ação -->
                <div class="action-buttons">
                    <button type="button" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </main>

    <!-- Rodapé -->
    <footer>
        <div class="container footer-content">
            <div class="footer-section">
                <h3>Sobre Nós</h3>
                <p>A Amou,Amado? é uma plataforma que buscar dar visibilidade para os eventos culturais e educativos
                    feitos por e para o público LGBTQIA+ de Salvador.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                </div>
            </div>

            <div class="footer-section">
                <h3>Links Rápidos</h3>
                <ul class="footer-links">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Eventos</a></li>
                    <li><a href="#">Artistas</a></li>
                    <li><a href="#">Locais</a></li>
                    <li><a href="#">Promoções</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>Contato</h3>
                <ul class="footer-links">
                    <li><i class="fas fa-envelope"></i> Amouamadocontato@gmail.com</li>
                    <li><i class="fas fa-phone"></i> (71) 99999-9999</li>
                    <li><i class="fas fa-map-marker-alt"></i> Salvador, BA - Brasil</li>
                </ul>
            </div>
        </div>

        <div class="copyright container">
            <p>&copy; 2023 ShowTime. Todos os direitos reservados.</p>
        </div>
    </footer>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');

    const avatarInput = document.getElementById('avatar-input');
    const coverInput = document.getElementById('cover-input');
    const avatarPreview = document.getElementById('avatar-preview');
    const coverPreview = document.getElementById('cover-preview');

    let avatarBase64 = null;
    let coverBase64 = null;

    async function fetchOrganizador() {
        const response = await fetch(`http://localhost:8080/api/organizadores/${id}`);
        const data = await response.json();

        document.getElementById('name').value = data.nome || '';
        document.getElementById('location').value = data.localizacao || '';
        document.getElementById('since').value = data.membroDesde || '';
        document.getElementById('bio').value = data.biografia || '';
        document.getElementById('email').value = data.email || '';
        document.getElementById('phone').value = data.telefone || '';
        document.getElementById('website').value = data.website || '';
        document.getElementById('events').value = data.eventosRealizados || 0;

        document.getElementById('instagram').value = data.instagram || '';
        document.getElementById('facebook').value = data.facebook || '';
        document.getElementById('twitter').value = data.twitter || '';
        document.getElementById('linkedin').value = data.linkedin || '';

        if (data.fotoPerfilUrl) {
            avatarPreview.innerHTML = `<img src="${data.fotoPerfilUrl}" alt="Foto de perfil">`;
            avatarBase64 = data.fotoPerfilUrl;
        }

        if (data.fotoCapaUrl) {
            coverPreview.innerHTML = `<img src="${data.fotoCapaUrl}" alt="Foto de capa">`;
            coverBase64 = data.fotoCapaUrl;
        }
    }

    async function toBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    }

    avatarInput.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (file) {
            avatarBase64 = await toBase64(file);
            avatarPreview.innerHTML = `<img src="${avatarBase64}" alt="Preview do Avatar">`;
        }
    });

    coverInput.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (file) {
            coverBase64 = await toBase64(file);
            coverPreview.innerHTML = `<img src="${coverBase64}" alt="Preview da Capa">`;
        }
    });

    document.getElementById('edit-profile-form').addEventListener('submit', async (e) => {
        e.preventDefault();

        const organizadorDTO = {
            nome: document.getElementById('name').value,
            localizacao: document.getElementById('location').value,
            membroDesde: document.getElementById('since').value,
            biografia: document.getElementById('bio').value,
            email: document.getElementById('email').value,
            telefone: document.getElementById('phone').value,
            website: document.getElementById('website').value,
            eventosRealizados: parseInt(document.getElementById('events').value) || 0,
            instagram: document.getElementById('instagram').value,
            facebook: document.getElementById('facebook').value,
            twitter: document.getElementById('twitter').value,
            linkedin: document.getElementById('linkedin').value,
            fotoPerfilUrl: avatarBase64,
            fotoCapaUrl: coverBase64
        };

        const response = await fetch(`http://localhost:8080/api/organizadores/${id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(organizadorDTO)
        });

        if (response.ok) {
            alert('Perfil atualizado com sucesso!');
            window.location.href = `perfilcriador.html?id=${id}`;
        } else {
            alert('Erro ao atualizar o perfil.');
        }
    });

    document.querySelector('.btn-secondary').addEventListener('click', () => {
        if (confirm('Deseja cancelar?')) {
            window.location.href = `perfilcriador.html?id=${id}`;
        }
    });

    fetchOrganizador();
});
</script>
</body>

</html>